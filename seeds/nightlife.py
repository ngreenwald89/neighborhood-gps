"""
File:
1. generates a single nightlife score per neighborhood. for now that's combining yelp and liquor license scores
2. seeds nightlife table in models
"""
from math import log
from tables.models import Neighborhood, Score
from .yelp_folder.yelp_api import run_list, get_yelp_score
from .mappings.mappings import nb_zip
from pprint import pprint

# function takes comprehensives nb dictionaries of the form: {'neighborhood': score}
# ADD CHECK THAT NEIGHBORHOODS ARE THE SAME FOR EVERY DICTIONARY PASSED AS ARGUMENT?
def generate_score(*args):
	pprint('IN GENERATE_SCORE')
	average_score = {}
	for arg in args:
		for nb in arg:
			if nb in average_score:
				average_score[nb] += arg[nb]
			else:
				average_score[nb] = arg[nb]
	
	for nb in average_score:
		average_score[nb] = round(average_score[nb]/float(len(args)))
	print('FINISHED GENERATE_SCORE, HAVE AVERAGE_SCORE')
	pprint(average_score)
	return average_score

def get_liquor_scores(my_dict):
	results = {}
	for key in my_dict:
		# log scales down liquor license counts
		score = round(log(my_dict[key]),2)
		results[key] = score
	return results



def update_nb_nightlife_score(score_dict):
	print('INSIDE update_nb_nightlife_score')
	# check if nb exists in score table
	for nb in score_dict:
		# may not be able to filter on foreign key attribute
		print(nb)
		nb_obj = Neighborhood.objects.filter(name=nb)
		print(nb_obj)
		if nb_obj:
			nb_obj = nb_obj[0]
			score_row = Score.objects.filter(neighborhood=nb_obj)
			# if nb_score exists
			# probably should use get_or_create()
			if score_row:
				score_row[0].night_life_score = score_dict[nb]
				score_row[0].save()
			else:
				# create nb_score
				nb_obj = Neighborhood.objects.get(name=nb)
				score_row = Score.objects.create(
					neighborhood=nb_obj,
					night_life_score=score_dict[nb],
					commute_score=0,
					crime_score=0,
					noise_score=0,				
				)
		else:
			print("DIDN'T FIND NB_OBJ: ", nb)

	return True
# this should call yelp api queries, get yelp scores, 
# average yelp scores with yelp scores for nightlife score, and seed Score table

# run call both yelp api requests and making nightlife scores, 
# but separating functions so we can run and get yelp responses, and work with making score bit
yelp_responses_4_28 = [{"Annadale-Huguenot-Prince's Bay-Eltingville": (44, 20, 3.525), 'DUMBO-Vinegar Hill-Downtown Brooklyn-Boerum H': (2870, 40, 4.225), 'Glen Oaks-Floral Park-New Hyde Park': (175, 20, 3.975), 'New Springville-Bloomfield-Travis': (134, 20, 3.6), 'Stuyvesant Town-Cooper Village': (14416, 40, 4.4125), 'Marble Hill-Inwood': (484, 20, 4.1), 'Queens Village': (627, 20, 4.025), 'Morningside Heights': (1080, 20, 3.9), 'Yorkville': (7673, 20, 4.3), 'Highbridge': (649, 20, 4.175), 'Mott Haven-Port Morris': (2507, 20, 4.225), 'Clinton Hill': (1216, 20, 4.3), 'Richmond Hill': (1410, 20, 3.925), 'Ridgewood': (2341, 20, 4.25), 'Canarsie': (832, 20, 3.675), 'Eastchester-Edenwald-Baychester': (124, 20, 3.85), 'Hunters Point-Sunnyside-West Maspeth': (845, 20, 4.3), 'East Concourse-Concourse Village': (568, 20, 4.025), 'Greenpoint': (8847, 20, 4.325), 'Williamsburg': (1369, 20, 4.35), 'Middle Village': (2450, 20, 4.125), 'Washington Heights North': (7967, 60, 4.183333333333334), 'Bay Ridge': (1250, 20, 4.2), 'Washington Heights South': (4791, 20, 4.25), 'Allerton-Pelham Gardens': (75, 20, 3.65), 'Bushwick North': (2813, 20, 4.425), 'Corona': (765, 20, 4.05), 'Woodlawn-Wakefield': (181, 20, 4.325), 'Bayside-Bayside Hills': (265, 20, 4.025), 'Woodhaven': (363, 20, 3.9), 'Dyker Heights': (1460, 20, 4.325), 'East New York (Pennsylvania Ave)': (943, 20, 3.6), 'Todt Hill-Emerson Hill-Heartland Village-Ligh': (548, 20, 3.875), 'Madison': (1803, 20, 4.125), 'Soundview-Bruckner': (298, 20, 3.875), 'South Ozone Park': (886, 20, 4.05), 'East Village': (4494, 20, 4.325), 'Glendale': (1627, 20, 3.825), 'Sheepshead Bay-Gerritsen Beach-Manhattan Beac': (326, 20, 4.125), 'Cambria Heights': (579, 20, 3.35), 'Bronxdale': (1365, 20, 4.125), 'Midtown-Midtown South': (8978, 20, 4.35), 'Oakland Gardens': (794, 20, 3.675), 'Co-Op City': (793, 20, 4.025), 'Fordham South': (1576, 20, 4.175), 'Crown Heights North': (3248, 20, 4.35), 'Rego Park': (2397, 20, 3.9), 'East Harlem South': (5783, 20, 4.475), 'Far Rockaway-Bayswater': (295, 20, 3.925), 'College Point': (1467, 20, 3.925), 'Kew Gardens Hills': (545, 20, 4.05), 'Bensonhurst East': (2107, 20, 4.05), 'Grymes Hill-Clifton-Fox Hills': (163, 20, 4.2), 'Crown Heights South': (3248, 20, 4.35), 'Ocean Hill': (2212, 20, 4.35), 'Bedford': (3957, 20, 4.325), 'Jamaica': (1071, 20, 4.075), 'Bellerose': (612, 20, 4.225), 'Baisley Park': (896, 20, 3.8), 'New Dorp-Midland Beach': (115, 20, 3.9), 'University Heights-Morris Heights': (1676, 20, 4.175), 'West New Brighton-New Brighton-St. George': (556, 20, 4.225), 'New Brighton-Silver Lake': (26, 20, 3.475), 'East Tremont': (1730, 20, 4.15), 'Van Cortlandt Village': (402, 20, 3.975), 'Melrose South-Mott Haven North': (1879, 20, 4.275), 'Kew Gardens': (545, 20, 4.05), 'Starrett City': (110, 20, 3.175), 'Fort Greene': (1380, 20, 4.125), 'Pelham Bay-Country Club-City Island': (52, 20, 3.65), 'Whitestone': (1056, 20, 3.825), 'West Village': (9275, 40, 4.1875), 'East Flushing': (720, 20, 4.125), 'Homecrest': (509, 20, 4.15), 'Elmhurst-Maspeth': (2978, 20, 4.2), 'Prospect Lefferts Gardens-Wingate': (3248, 20, 4.35), 'Jamaica Estates-Holliswood': (828, 20, 4.125), 'North Riverdale-Fieldston-Riverdale': (152, 20, 3.975), 'Cypress Hills-City Line': (1332, 20, 3.95), 'Brighton Beach': (991, 20, 4.075), 'Midwood': (1803, 20, 4.125), 'Grasmere-Arrochar-Ft. Wadsworth': (90, 20, 3.85), 'Stapleton-Rosebank': (124, 20, 4.0), 'Ocean Parkway South': (5773, 20, 4.25), 'Crotona Park East': (1557, 20, 4.175), 'Hollis': (176, 20, 3.625), 'Rugby-Remsen Village': (2181, 20, 4.175), 'East Williamsburg': (4840, 20, 4.425), 'Pomonok-Flushing Heights-Hillcrest': (1916, 40, 4.225), 'Flushing': (4237, 20, 4.3), 'Murray Hill-Kips Bay': (5709, 20, 4.15), 'Soundview-Castle Hill-Clason Point-Harding Pa': (1117, 20, 4.1), 'Borough Park': (5766, 20, 4.175), 'Georgetown-Marine Park-Bergen Beach-Mill Basi': (185, 20, 4.05), 'Brownsville': (1857, 20, 4.025), 'East Harlem North': (861, 20, 4.125), 'Williamsbridge-Olinville': (6065, 40, 4.15), 'Hunts Point': (143, 20, 4.0), 'Upper West Side': (10432, 40, 4.15), 'Laurelton': (614, 20, 3.55), 'Auburndale': (1179, 20, 4.275), 'Central Harlem North-Polo Grounds': (699, 20, 4.225), 'Woodside': (17310, 20, 4.3), 'Gramercy': (478, 20, 4.125), 'Stuyvesant Heights': (780, 20, 4.175), 'West Concourse': (580, 20, 3.725), 'Windsor Terrace': (859, 20, 3.925), 'North Side-South Side': (90, 20, 4.05), 'Astoria': (3310, 20, 4.4), 'Great Kills': (264, 20, 3.875), 'East Elmhurst': (2079, 20, 4.2), 'Jackson Heights': (2487, 20, 4.3), 'Prospect Heights': (3921, 20, 4.15), 'Steinway': (2910, 20, 4.225), 'Elmhurst': (2904, 20, 4.175), 'Rossville-Woodrow': (57, 20, 3.8), 'East Flatbush-Farragut': (495, 20, 3.85), 'Sunset Park East': (1804, 20, 4.25), 'Queensbridge-Ravenswood-Long Island City': (13033, 40, 4.3), 'Briarwood-Jamaica Hills': (4522, 20, 4.3), "Mariner's Harbor-Arlington-Port Ivory-Granite": (1515, 20, 4.075), 'Morrisania-Melrose': (400, 20, 4.075), 'Old Town-Dongan Hills-South Beach': (124, 20, 4.0), 'Hamilton Heights': (11807, 20, 4.175), 'Forest Hills': (6150, 20, 4.25), 'Lindenwood-Howard Beach': (491, 20, 4.125), 'Bushwick South': (2813, 20, 4.425), 'Van Nest-Morris Park-Westchester Square': (152, 20, 3.95), 'Bensonhurst West': (2028, 20, 4.075), 'Gravesend': (1548, 20, 4.225), 'Rosedale': (2181, 20, 4.025), 'Springfield Gardens South-Brookville': (127, 20, 3.4), 'Upper East Side-Carnegie Hill': (14212, 80, 4.2875), 'Oakwood-Oakwood Beach': (177, 20, 4.05), 'Flatbush': (2595, 20, 4.25), 'Fresh Meadows-Utopia': (1604, 20, 3.925), 'Brooklyn Heights-Cobble Hill': (1851, 20, 4.0), 'Queensboro Hill': (691, 20, 4.075), 'Breezy Point-Belle Harbor-Rockaway Park-Broad': (1452, 20, 4.05), 'Murray Hill': (5351, 20, 4.125), 'Douglas Manor-Douglaston-Little Neck': (163, 20, 4.025), 'Chinatown': (3661, 20, 4.1), 'Parkchester': (405, 20, 4.025), 'Pelham Parkway': (369, 20, 4.125), 'Spuyten Duyvil-Kingsbridge': (529, 20, 3.85), 'Clinton': (26823, 60, 4.2), 'Mount Hope': (4960, 20, 4.325), 'Charleston-Richmond Valley-Tottenville': (61, 20, 3.925), 'Carroll Gardens-Columbia Street-Red Hook': (878, 20, 4.3), 'Manhattanville': (2573, 20, 4.225), 'Ft. Totten-Bay Terrace-Clearview': (45, 20, 3.55), 'Lincoln Square': (6679, 20, 4.0), 'Springfield Gardens North': (147, 20, 3.825), 'East New York': (1350, 20, 3.625), 'West Farms-Bronx River': (465, 20, 3.975), 'Arden Heights': (70, 20, 3.875), 'Schuylerville-Throgs Neck-Edgewater Park': (105, 20, 3.975), 'Bath Beach': (1307, 20, 3.9), 'Hammels-Arverne-Edgemere': (46, 20, 3.5), 'Old Astoria': (107, 20, 4.125), 'Norwood': (1254, 20, 4.0), 'Sunset Park West': (1804, 20, 4.25), 'Belmont': (464, 20, 4.2), 'Westchester-Unionport': (393, 20, 4.025), 'Erasmus': (633, 20, 4.275), 'North Corona': (719, 20, 4.3), 'Central Harlem South': (4696, 20, 4.4), 'Port Richmond': (159, 20, 4.325), 'South Jamaica': (1021, 20, 4.075), 'Kingsbridge Heights': (529, 20, 3.85), 'Lenox Hill-Roosevelt Island': (3234, 20, 4.275), 'Westerleigh': (462, 20, 4.1), 'Hudson Yards-Chelsea-Flat Iron-Union Square': (9802, 40, 4.2125), 'Flatlands': (1552, 20, 3.8), 'Longwood': (291, 20, 4.075), 'St. Albans': (794, 20, 4.025), 'Kensington-Ocean Parkway': (604, 20, 4.125), 'West Brighton': (551, 20, 4.05), 'Bedford Park-Fordham North': (1366, 20, 4.075), 'SoHo-TriBeCa-Civic Center-Little Italy': (7252, 40, 4.2125), 'Maspeth': (3041, 20, 3.875), 'Battery Park City-Lower Manhattan': (19120, 100, 4.175), 'Ozone Park': (968, 20, 3.95), 'Rikers Island': (36569, 20, 4.575), 'Claremont-Bathgate': (400, 20, 3.975), 'Turtle Bay-East Midtown': (9396, 20, 4.375), 'Lower East Side': (3625, 20, 4.35), 'Seagate-Coney Island': (991, 20, 4.075)}, {"Annadale-Huguenot-Prince's Bay-Eltingville": (44, 20, 3.525), 'DUMBO-Vinegar Hill-Downtown Brooklyn-Boerum H': (2870, 40, 4.225), 'Glen Oaks-Floral Park-New Hyde Park': (175, 20, 3.975), 'New Springville-Bloomfield-Travis': (134, 20, 3.6), 'Stuyvesant Town-Cooper Village': (14416, 40, 4.4125), 'Marble Hill-Inwood': (484, 20, 4.1), 'Queens Village': (627, 20, 4.025), 'Morningside Heights': (1080, 20, 3.9), 'Yorkville': (7673, 20, 4.3), 'Highbridge': (649, 20, 4.175), 'Mott Haven-Port Morris': (2507, 20, 4.225), 'Clinton Hill': (1216, 20, 4.3), 'Richmond Hill': (1410, 20, 3.925), 'Ridgewood': (2341, 20, 4.25), 'Canarsie': (832, 20, 3.675), 'Eastchester-Edenwald-Baychester': (124, 20, 3.85), 'Hunters Point-Sunnyside-West Maspeth': (845, 20, 4.3), 'East Concourse-Concourse Village': (568, 20, 4.025), 'Greenpoint': (8847, 20, 4.325), 'Williamsburg': (1369, 20, 4.35), 'Middle Village': (2450, 20, 4.125), 'Washington Heights North': (7967, 60, 4.183333333333334), 'Bay Ridge': (1250, 20, 4.2), 'Washington Heights South': (4791, 20, 4.25), 'Allerton-Pelham Gardens': (75, 20, 3.65), 'Bushwick North': (2813, 20, 4.425), 'Corona': (765, 20, 4.05), 'Woodlawn-Wakefield': (181, 20, 4.325), 'Bayside-Bayside Hills': (265, 20, 4.025), 'Woodhaven': (363, 20, 3.9), 'Dyker Heights': (1460, 20, 4.325), 'East New York (Pennsylvania Ave)': (943, 20, 3.6), 'Todt Hill-Emerson Hill-Heartland Village-Ligh': (548, 20, 3.875), 'Madison': (1803, 20, 4.125), 'Soundview-Bruckner': (298, 20, 3.875), 'South Ozone Park': (886, 20, 4.05), 'East Village': (4494, 20, 4.325), 'Glendale': (1627, 20, 3.825), 'Sheepshead Bay-Gerritsen Beach-Manhattan Beac': (326, 20, 4.125), 'Cambria Heights': (579, 20, 3.35), 'Bronxdale': (1365, 20, 4.125), 'Midtown-Midtown South': (8978, 20, 4.35), 'Oakland Gardens': (794, 20, 3.675), 'Co-Op City': (793, 20, 4.025), 'Fordham South': (1576, 20, 4.175), 'Crown Heights North': (3248, 20, 4.35), 'Rego Park': (2397, 20, 3.9), 'East Harlem South': (5783, 20, 4.475), 'Far Rockaway-Bayswater': (295, 20, 3.925), 'College Point': (1467, 20, 3.925), 'Kew Gardens Hills': (545, 20, 4.05), 'Bensonhurst East': (2107, 20, 4.05), 'Grymes Hill-Clifton-Fox Hills': (163, 20, 4.2), 'Crown Heights South': (3248, 20, 4.35), 'Ocean Hill': (2212, 20, 4.35), 'Bedford': (3957, 20, 4.325), 'Jamaica': (1071, 20, 4.075), 'Bellerose': (612, 20, 4.225), 'Baisley Park': (896, 20, 3.8), 'New Dorp-Midland Beach': (115, 20, 3.9), 'University Heights-Morris Heights': (1676, 20, 4.175), 'West New Brighton-New Brighton-St. George': (556, 20, 4.225), 'New Brighton-Silver Lake': (26, 20, 3.475), 'East Tremont': (1730, 20, 4.15), 'Van Cortlandt Village': (402, 20, 3.975), 'Melrose South-Mott Haven North': (1879, 20, 4.275), 'Kew Gardens': (545, 20, 4.05), 'Starrett City': (110, 20, 3.175), 'Fort Greene': (1380, 20, 4.125), 'Pelham Bay-Country Club-City Island': (52, 20, 3.65), 'Whitestone': (1056, 20, 3.825), 'West Village': (9275, 40, 4.1875), 'East Flushing': (720, 20, 4.125), 'Homecrest': (509, 20, 4.15), 'Elmhurst-Maspeth': (2978, 20, 4.2), 'Prospect Lefferts Gardens-Wingate': (3248, 20, 4.35), 'Jamaica Estates-Holliswood': (828, 20, 4.125), 'North Riverdale-Fieldston-Riverdale': (152, 20, 3.975), 'Cypress Hills-City Line': (1332, 20, 3.95), 'Brighton Beach': (991, 20, 4.075), 'Midwood': (1803, 20, 4.125), 'Grasmere-Arrochar-Ft. Wadsworth': (90, 20, 3.85), 'Stapleton-Rosebank': (124, 20, 4.0), 'Ocean Parkway South': (5773, 20, 4.25), 'Crotona Park East': (1557, 20, 4.175), 'Hollis': (176, 20, 3.625), 'Rugby-Remsen Village': (2181, 20, 4.175), 'East Williamsburg': (4840, 20, 4.425), 'Pomonok-Flushing Heights-Hillcrest': (1916, 40, 4.225), 'Flushing': (4237, 20, 4.3), 'Murray Hill-Kips Bay': (5709, 20, 4.15), 'Soundview-Castle Hill-Clason Point-Harding Pa': (1117, 20, 4.1), 'Borough Park': (5766, 20, 4.175), 'Georgetown-Marine Park-Bergen Beach-Mill Basi': (185, 20, 4.05), 'Brownsville': (1857, 20, 4.025), 'East Harlem North': (861, 20, 4.125), 'Williamsbridge-Olinville': (6065, 40, 4.15), 'Hunts Point': (143, 20, 4.0), 'Upper West Side': (10432, 40, 4.15), 'Laurelton': (614, 20, 3.55), 'Auburndale': (1179, 20, 4.275), 'Central Harlem North-Polo Grounds': (699, 20, 4.225), 'Woodside': (17310, 20, 4.3), 'Gramercy': (478, 20, 4.125), 'Stuyvesant Heights': (780, 20, 4.175), 'West Concourse': (580, 20, 3.725), 'Windsor Terrace': (859, 20, 3.925), 'North Side-South Side': (90, 20, 4.05), 'Astoria': (3310, 20, 4.4), 'Great Kills': (264, 20, 3.875), 'East Elmhurst': (2079, 20, 4.2), 'Jackson Heights': (2487, 20, 4.3), 'Prospect Heights': (3921, 20, 4.15), 'Steinway': (2910, 20, 4.225), 'Elmhurst': (2904, 20, 4.175), 'Rossville-Woodrow': (57, 20, 3.8), 'East Flatbush-Farragut': (495, 20, 3.85), 'Sunset Park East': (1804, 20, 4.25), 'Queensbridge-Ravenswood-Long Island City': (13033, 40, 4.3), 'Briarwood-Jamaica Hills': (4522, 20, 4.3), "Mariner's Harbor-Arlington-Port Ivory-Granite": (1515, 20, 4.075), 'Morrisania-Melrose': (400, 20, 4.075), 'Old Town-Dongan Hills-South Beach': (124, 20, 4.0), 'Hamilton Heights': (11807, 20, 4.175), 'Forest Hills': (6150, 20, 4.25), 'Lindenwood-Howard Beach': (491, 20, 4.125), 'Bushwick South': (2813, 20, 4.425), 'Van Nest-Morris Park-Westchester Square': (152, 20, 3.95), 'Bensonhurst West': (2028, 20, 4.075), 'Gravesend': (1548, 20, 4.225), 'Rosedale': (2181, 20, 4.025), 'Springfield Gardens South-Brookville': (127, 20, 3.4), 'Upper East Side-Carnegie Hill': (14212, 80, 4.2875), 'Oakwood-Oakwood Beach': (177, 20, 4.05), 'Flatbush': (2595, 20, 4.25), 'Fresh Meadows-Utopia': (1604, 20, 3.925), 'Brooklyn Heights-Cobble Hill': (1851, 20, 4.0), 'Queensboro Hill': (691, 20, 4.075), 'Breezy Point-Belle Harbor-Rockaway Park-Broad': (1452, 20, 4.05), 'Murray Hill': (5351, 20, 4.125), 'Douglas Manor-Douglaston-Little Neck': (163, 20, 4.025), 'Chinatown': (3661, 20, 4.1), 'Parkchester': (405, 20, 4.025), 'Pelham Parkway': (369, 20, 4.125), 'Spuyten Duyvil-Kingsbridge': (529, 20, 3.85), 'Clinton': (26823, 60, 4.2), 'Mount Hope': (4960, 20, 4.325), 'Charleston-Richmond Valley-Tottenville': (61, 20, 3.925), 'Carroll Gardens-Columbia Street-Red Hook': (878, 20, 4.3), 'Manhattanville': (2573, 20, 4.225), 'Ft. Totten-Bay Terrace-Clearview': (45, 20, 3.55), 'Lincoln Square': (6679, 20, 4.0), 'Springfield Gardens North': (147, 20, 3.825), 'East New York': (1350, 20, 3.625), 'West Farms-Bronx River': (465, 20, 3.975), 'Arden Heights': (70, 20, 3.875), 'Schuylerville-Throgs Neck-Edgewater Park': (105, 20, 3.975), 'Bath Beach': (1307, 20, 3.9), 'Hammels-Arverne-Edgemere': (46, 20, 3.5), 'Old Astoria': (107, 20, 4.125), 'Norwood': (1254, 20, 4.0), 'Sunset Park West': (1804, 20, 4.25), 'Belmont': (464, 20, 4.2), 'Westchester-Unionport': (393, 20, 4.025), 'Erasmus': (633, 20, 4.275), 'North Corona': (719, 20, 4.3), 'Central Harlem South': (4696, 20, 4.4), 'Port Richmond': (159, 20, 4.325), 'South Jamaica': (1021, 20, 4.075), 'Kingsbridge Heights': (529, 20, 3.85), 'Lenox Hill-Roosevelt Island': (3234, 20, 4.275), 'Westerleigh': (462, 20, 4.1), 'Hudson Yards-Chelsea-Flat Iron-Union Square': (9802, 40, 4.2125), 'Flatlands': (1552, 20, 3.8), 'Longwood': (291, 20, 4.075), 'St. Albans': (794, 20, 4.025), 'Kensington-Ocean Parkway': (604, 20, 4.125), 'West Brighton': (551, 20, 4.05), 'Bedford Park-Fordham North': (1366, 20, 4.075), 'SoHo-TriBeCa-Civic Center-Little Italy': (7252, 40, 4.2125), 'Maspeth': (3041, 20, 3.875), 'Battery Park City-Lower Manhattan': (19120, 100, 4.175), 'Ozone Park': (968, 20, 3.95), 'Rikers Island': (36569, 20, 4.575), 'Claremont-Bathgate': (400, 20, 3.975), 'Turtle Bay-East Midtown': (9396, 20, 4.375), 'Lower East Side': (3625, 20, 4.35), 'Seagate-Coney Island': (991, 20, 4.075)}]
logged_liquor_4_28 = {'Maspeth': 4.43, 'Dyker Heights': 4.2, 'Bushwick South': 5.35, 'South Jamaica': 3.71, 'Jamaica Estates-Holliswood': 3.4, 'East Flushing': 5.44, 'East New York (Pennsylvania Ave)': 5.21, 'Bronxdale': 4.78, 'Grasmere-Arrochar-Ft. Wadsworth': 4.17, 'DUMBO-Vinegar Hill-Downtown Brooklyn-Boerum H': 6.11, 'Madison': 4.74, 'Williamsbridge-Olinville': 5.27, 'Flatlands': 4.82, 'Rosedale': 3.3, 'Kew Gardens Hills': 3.43, 'Queens Village': 3.37, 'Ozone Park': 4.06, 'Hamilton Heights': 4.61, 'Old Astoria': 4.43, 'Bushwick North': 5.35, 'Old Town-Dongan Hills-South Beach': 4.52, 'Grymes Hill-Clifton-Fox Hills': 4.51, 'Springfield Gardens South-Brookville': 3.5, 'Lenox Hill-Roosevelt Island': 4.38, 'Woodlawn-Wakefield': 4.2, 'Crown Heights North': 4.56, 'Longwood': 4.5, 'Windsor Terrace': 5.73, 'Hunts Point': 3.56, 'Murray Hill': 5.86, 'Bedford': 4.84, 'Bedford Park-Fordham North': 5.12, 'Morningside Heights': 4.76, 'Murray Hill-Kips Bay': 5.86, 'West New Brighton-New Brighton-St. George': 3.97, 'Prospect Heights': 5.41, 'Astoria': 5.17, 'Oakwood-Oakwood Beach': 4.41, 'Morrisania-Melrose': 4.78, 'Westerleigh': 4.84, 'Oakland Gardens': 3.56, 'Belmont': 5.12, 'Rugby-Remsen Village': 4.74, 'Seagate-Coney Island': 4.39, 'Westchester-Unionport': 4.88, 'Borough Park': 4.61, 'New Dorp-Midland Beach': 4.41, 'Bensonhurst West': 5.02, 'Co-Op City': 3.58, 'Woodhaven': 4.25, 'Hunters Point-Sunnyside-West Maspeth': 4.53, 'Middle Village': 3.87, 'Ocean Hill': 4.53, 'Corona': 5.66, 'East Flatbush-Farragut': 4.74, 'Midwood': 4.38, 'Glendale': 5.63, 'Bay Ridge': 5.35, 'Manhattanville': 4.76, 'Bayside-Bayside Hills': 4.62, 'Parkchester': 4.78, 'East Williamsburg': 6.17, 'Melrose South-Mott Haven North': 4.61, 'Forest Hills': 5.02, 'Rossville-Woodrow': 4.13, 'Stuyvesant Town-Cooper Village': 6.21, 'University Heights-Morris Heights': 4.84, 'West Concourse': 4.61, 'Great Kills': 3.95, 'Cypress Hills-City Line': 5.12, 'Fresh Meadows-Utopia': 3.53, 'Upper West Side': 5.94, 'Mount Hope': 6.29, 'Richmond Hill': 4.52, 'Clinton Hill': 4.88, 'Ridgewood': 5.63, 'Brownsville': 4.78, 'New Springville-Bloomfield-Travis': 4.84, 'Kew Gardens': 3.43, 'Central Harlem North-Polo Grounds': 3.18, 'Hammels-Arverne-Edgemere': 2.08, 'Queensbridge-Ravenswood-Long Island City': 5.98, 'East Tremont': 4.88, 'Port Richmond': 4.14, 'Yorkville': 5.06, 'Steinway': 4.84, 'Brooklyn Heights-Cobble Hill': 5.55, 'Battery Park City-Lower Manhattan': 5.53, 'North Riverdale-Fieldston-Riverdale': 3.47, 'Chinatown': 5.81, 'Glen Oaks-Floral Park-New Hyde Park': 4.61, 'West Village': 6.57, 'South Ozone Park': 3.14, 'Crotona Park East': 4.48, 'Gramercy': 6.29, 'Erasmus': 5.03, 'Gravesend': 5.1, 'Bellerose': 3.09, 'Bath Beach': 5.02, 'Elmhurst-Maspeth': 5.05, 'East New York': 5.21, 'Laurelton': 3.5, 'Hudson Yards-Chelsea-Flat Iron-Union Square': 6.59, 'Brighton Beach': 5.19, 'Jamaica': 4.57, 'West Farms-Bronx River': 4.48, 'Greenpoint': 5.44, 'Washington Heights South': 4.7, 'North Corona': 5.66, "Mariner's Harbor-Arlington-Port Ivory-Granite": 3.66, 'Ocean Parkway South': 4.38, 'Allerton-Pelham Gardens': 4.19, 'Baisley Park': 4.23, 'Homecrest': 5.1, 'New Brighton-Silver Lake': 4.51, 'Williamsburg': 6.17, 'SoHo-TriBeCa-Civic Center-Little Italy': 6.03, "Annadale-Huguenot-Prince's Bay-Eltingville": 4.19, 'Far Rockaway-Bayswater': 3.87, 'Hollis': 3.4, 'Sunset Park West': 5.41, 'Pelham Bay-Country Club-City Island': 3.56, 'Breezy Point-Belle Harbor-Rockaway Park-Broad': 2.4, 'Midtown-Midtown South': 6.17, 'Soundview-Bruckner': 4.8, 'Highbridge': 4.95, 'Eastchester-Edenwald-Baychester': 3.58, 'Norwood': 4.91, 'Queensboro Hill': 4.82, 'Spuyten Duyvil-Kingsbridge': 4.62, 'East Village': 5.71, 'Bensonhurst East': 4.65, 'Springfield Gardens North': 3.5, 'West Brighton': 3.97, 'Starrett City': 2.56, 'Flatbush': 5.03, 'Lincoln Square': 5.03, 'Turtle Bay-East Midtown': 5.8, 'Cambria Heights': 2.89, 'East Concourse-Concourse Village': 4.61, 'Georgetown-Marine Park-Bergen Beach-Mill Basi': 4.82, 'Carroll Gardens-Columbia Street-Red Hook': 5.18, 'Central Harlem South': 4.16, 'Marble Hill-Inwood': 4.64, 'College Point': 3.95, 'Flushing': 5.44, 'Woodside': 5.36, 'Sheepshead Bay-Gerritsen Beach-Manhattan Beac': 5.19, 'Crown Heights South': 4.56, 'Todt Hill-Emerson Hill-Heartland Village-Ligh': 4.17, 'Douglas Manor-Douglaston-Little Neck': 3.47, 'Prospect Lefferts Gardens-Wingate': 4.56, 'Claremont-Bathgate': 4.88, 'Fordham South': 5.12, 'Pomonok-Flushing Heights-Hillcrest': 6.01, 'Upper East Side-Carnegie Hill': 6.43, 'Soundview-Castle Hill-Clason Point-Harding Pa': 4.8, 'Jackson Heights': 5.53, 'Kingsbridge Heights': 4.62, 'Whitestone': 4.09, 'Charleston-Richmond Valley-Tottenville': 3.37, 'Briarwood-Jamaica Hills': 4.78, 'Clinton': 7.03, 'Sunset Park East': 5.41, 'East Harlem North': 3.09, 'Stuyvesant Heights': 4.53, 'Van Cortlandt Village': 4.61, 'Schuylerville-Throgs Neck-Edgewater Park': 4.26, 'Washington Heights North': 5.69, 'East Elmhurst': 3.81, 'East Harlem South': 5.04, 'Rego Park': 4.39, 'St. Albans': 3.76, 'Mott Haven-Port Morris': 4.5, 'Lower East Side': 5.9, 'Lindenwood-Howard Beach': 3.69, 'Auburndale': 4.86, 'Stapleton-Rosebank': 4.52, 'Fort Greene': 4.88, 'Van Nest-Morris Park-Westchester Square': 4.78, 'Kensington-Ocean Parkway': 4.83, 'Elmhurst': 5.05, 'Ft. Totten-Bay Terrace-Clearview': 2.77, 'Canarsie': 4.47}

def run_yelp_calls():
	terms=['bars', 'restaurants']
	yelp_responses = run_list(nb_dict=nb_zip, terms=terms)
	pprint('GOT YELP_RESPONSES, LN 314 IN NIGHTLIFE.PY')
	pprint(yelp_responses)
	return yelp_responses

def nightlife_score(yelp_responses):
	yelp_scores = []
	for response in yelp_responses:
		pprint('IN GET_YELP_SCORE LOOP')
		yelp_scores.append(get_yelp_score(response))
	pprint('FINISHED GET_YELP_SCORE LOOP')
	yelp_plus_liquor = generate_score(logged_liquor_4_28, *yelp_scores)
	print('FINISHED GENERATE_SCORE, GOING TO update_nb_nightlife_score')
	update_nb_nightlife_score(yelp_plus_liquor)
	return True

def run():
	yelp_responses = run_yelp_calls()
	return nightlife_score(yelp_responses)
	